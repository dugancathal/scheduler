#!/usr/bin/env ruby

require 'optparse'
#require 'ruby-debug'
dirname = File.dirname(__FILE__)
require File.join(dirname, 'scheduler')
Dir['*.rb'].each do |rb_file|
  require File.join(dirname, rb_file)
end

options = {}
unless ARGV.empty?
  OptionParser.new do |opts|
    opts.on("-d", "--detailed", "Detailed Output") do |d|
      options[:mode] = :detailed
    end

    opts.on("-v", "--verbose", "Verbose Output") do |v|
      options[:mode] = :verbose
    end

    opts.on("-t", "--type TYPE", "Type of Scheduler",
                                  "Should be one of: FCFSScheduler, RRScheduler") do |t|
      t = 'Sim::' + t                              
      options[:type] = instance_eval(t)
    end                              
  end.parse!
end
options[:mode] ||= :default
options[:type] ||= Sim::FCFSScheduler
ARGV.clear

#Sim::Scheduler.new.run! options[:mode]

Sim::System.new.run! options
